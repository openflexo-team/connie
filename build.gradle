buildscript {
  repositories {
    jcenter()
  }
 
  dependencies {
    classpath 'org.anarres.gradle:gradle-sablecc-plugin:[1.0.4,)'
  }
}

subprojects {
  group='org.openflexo'
  apply plugin: 'java'

  apply plugin: 'maven'

  //  apply plugin: 'checkstyle'
  //  apply plugin: 'pmd'
  //  apply plugin: 'findbugs'
  //  apply plugin: 'Site'
  
  //  sourceCompatibility = 1.7
  //  targetCompatibility = 1.7

  compileJava.options.encoding = 'UTF-8'
  project.buildDir = 'target'
  
  repositories {
    jcenter()
    maven {
      url "https://maven.openflexo.org/artifactory/openflexo-snapshot/"
    }
  }
 
  dependencies {
    testCompile group: 'junit', name: 'junit', version: '4.+'
  }

  test {
    testLogging {
      // Show that tests are run in the command-line output
      events 'passed' //'started', 
      //showStandardStreams = true
    }
  }

  if (JavaVersion.current().isJava8Compatible()) {
    allprojects {
      tasks.withType(Javadoc) {
	options.addBooleanOption('Xdoclint:none', true)
      }
    }
  }

  task testJar(type: Jar) {
    classifier = 'tests'
    from sourceSets.test.output
  }

  task sourcesJar(type: Jar, dependsOn: classes) {
    classifier = 'sources'
    from sourceSets.main.allSource
  }

  task javadocJar(type: Jar, dependsOn: javadoc) {
    classifier = 'javadoc'
    from javadoc.destinationDir
  }

  artifacts {
    archives sourcesJar
    archives javadocJar
    archives testJar
  }
}

apply plugin: 'maven'
apply plugin: 'project-report'

htmlDependencyReport {
    projects = project.allprojects
}

archivesBaseName = 'connie'
group = 'org.openflexo'
version = '1.4-SNAPSHOT'

uploadArchives {
  repositories {
    mavenDeployer {
      repository(url: 'file:./maven')
    }
  }
}
